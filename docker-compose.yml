version: '3.8'

services:
  ai-restorer:
    # Make sure this matches the image you pushed to Docker Hub
    image: abdulraufazhar/ai-image-upscaler:latest
    container_name: ai-image-upscaler
    restart: always
    
    # CRITICAL UPDATE: Link the .env file from your VPS into the container
    env_file:
      - .env
      
    ports:
      - "8001:8001"
      - "8091:8091"
      
    volumes:
      # Persist the output images so they don't vanish on restart
      - ./processed_images:/app/processed_images
      
    deploy:
      resources:
        limits:
          # Good safety measure for a CPU VPS
          memory: 4G